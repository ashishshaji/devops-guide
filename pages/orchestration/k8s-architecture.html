<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Architecture: The Brain & The Body</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #326CE5;
            --secondary: #39A0F4;
            --accent: #FFEB3B;
            --dark: #1e293b;
            --light: #f8fafc;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--light);
            color: var(--dark);
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        /* Interactive Component Styling */
        .interactive-block {
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .interactive-block:hover {
            transform: translateY(-3px);
            filter: brightness(0.95);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Modal Animation */
        #componentModal {
            transition: opacity 0.3s ease;
            display: none;
        }
        .modal-content {
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        #componentModal.active {
            display: flex;
            opacity: 1;
        }
        #componentModal.active .modal-content {
            transform: scale(1);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 4px; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased">

    <!-- SHARED NAVIGATION HEADER -->
    <nav class="glass-nav sticky top-0 z-50 py-4 px-6 mb-0">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <a href="https://ashishshaji.github.io/devops-guide/" class="flex items-center gap-2 group">
                <div class="bg-blue-600 p-2 rounded-lg text-white group-hover:bg-slate-900 transition-colors">
                    <i class="fas fa-arrow-left"></i>
                </div>
                <div class="flex flex-col">
                    <span class="text-[10px] font-bold text-blue-600 uppercase tracking-tighter leading-none">Back to</span>
                    <span class="text-sm font-bold text-slate-900 leading-tight">Visual Library</span>
                </div>
            </a>
            
            <div class="flex items-center gap-3">
                <div class="hidden md:block text-right">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">DevOps Insights</p>
                    <p class="text-xs font-bold text-slate-700">Architecture Library</p>
                </div>
                <div class="h-8 w-px bg-slate-200 mx-2 hidden md:block"></div>
                <button class="text-slate-500 hover:text-blue-600 transition-colors">
                    <i class="fas fa-share-alt"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <header class="bg-gradient-to-r from-blue-700 to-cyan-500 text-white p-12 text-center shadow-lg mb-12">
        <h1 class="text-5xl font-bold mb-4">Kubernetes Architecture</h1>
        <p class="text-xl opacity-90 max-w-2xl mx-auto">The "Brain" and the "Body" of modern container orchestration.</p>
        <div class="mt-8 flex justify-center gap-4 flex-wrap">
            <span class="bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm"><i class="fas fa-cubes mr-2"></i>Orchestration</span>
            <span class="bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm"><i class="fas fa-heartbeat mr-2"></i>Self-Healing</span>
            <span class="bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm"><i class="fas fa-expand-arrows-alt mr-2"></i>Auto-Scaling</span>
        </div>
    </header>

    <main class="container mx-auto px-4 max-w-6xl space-y-20 pb-20">

        <!-- SECTION 1: THE WHY -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <div class="border-l-4 border-blue-600 pl-4">
                    <h2 class="text-3xl font-bold text-slate-800">Why Kubernetes?</h2>
                    <p class="text-slate-500 font-medium">From Manual to Automatic</p>
                </div>
                <p class="text-lg leading-relaxed text-slate-600">
                    Managing containers with raw Docker is like juggling manually. Kubernetes introduces a "Cluster" mind, bringing enterprise-grade capabilities that standalone Docker lacks.
                </p>
                <ul class="space-y-3">
                    <li class="flex items-center text-slate-700">
                        <span class="w-8 h-8 bg-red-100 text-red-600 rounded-full flex items-center justify-center mr-3"><i class="fas fa-times"></i></span>
                        <span><strong>Docker:</strong> Single Host, No Auto-Healing, Manual Scaling.</span>
                    </li>
                    <li class="flex items-center text-slate-700">
                        <span class="w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center mr-3"><i class="fas fa-check"></i></span>
                        <span><strong>Kubernetes:</strong> Multi-Node Cluster, Auto-Restart, Auto-Scaling.</span>
                    </li>
                </ul>
            </div>
            
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                <h3 class="text-center font-bold text-slate-700 mb-4">Capability Comparison</h3>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </section>

        <!-- SECTION 2: THE ARCHITECTURE (Diagram) -->
        <section id="architecture">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">The Cluster Anatomy</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">Click any component below to pop out its functionality.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 bg-slate-200 p-6 rounded-2xl border border-slate-300">
                
                <!-- CONTROL PLANE (Master) -->
                <div class="lg:col-span-5 bg-white rounded-xl shadow-md border-t-4 border-blue-600 p-6 flex flex-col gap-4 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded-bl">MASTER NODE</div>
                    <div class="text-center mb-2">
                        <h3 class="text-xl font-bold text-blue-700"><i class="fas fa-brain mr-2"></i>Control Plane</h3>
                        <p class="text-xs text-slate-500">The Brain & Decision Maker</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div onclick="showDetails('api')" class="interactive-block col-span-2 bg-blue-50 border border-blue-200 p-3 rounded-lg text-center shadow-sm">
                            <h4 class="font-bold text-blue-800 text-sm">API Server</h4>
                            <p class="text-xs text-slate-600">The Gatekeeper (REST API)</p>
                        </div>
                        <div onclick="showDetails('scheduler')" class="interactive-block bg-indigo-50 border border-indigo-200 p-3 rounded-lg text-center shadow-sm">
                            <h4 class="font-bold text-indigo-800 text-sm">Scheduler</h4>
                            <p class="text-xs text-slate-600">The Dispatcher</p>
                        </div>
                        <div onclick="showDetails('controller')" class="interactive-block bg-indigo-50 border border-indigo-200 p-3 rounded-lg text-center shadow-sm">
                            <h4 class="font-bold text-indigo-800 text-sm">Controller Mgr</h4>
                            <p class="text-xs text-slate-600">The State Police</p>
                        </div>
                        <div onclick="showDetails('etcd')" class="interactive-block col-span-2 bg-amber-50 border border-amber-200 p-3 rounded-lg text-center shadow-sm">
                            <h4 class="font-bold text-amber-800 text-sm">etcd</h4>
                            <p class="text-xs text-slate-600">The Memory (Cluster Store)</p>
                        </div>
                    </div>
                </div>

                <!-- CONNECTOR -->
                <div class="lg:col-span-2 flex flex-col justify-center items-center text-slate-400">
                    <div class="hidden lg:block border-t-2 border-dashed border-slate-400 w-full relative top-4"></div>
                    <span class="bg-slate-200 px-2 z-10 font-mono text-xs text-center">HTTPS / API Calls</span>
                    <div class="hidden lg:block border-t-2 border-dashed border-slate-400 w-full relative bottom-4"></div>
                    <div class="lg:hidden text-2xl py-4"><i class="fas fa-arrow-down"></i></div>
                </div>

                <!-- DATA PLANE (Worker) -->
                <div class="lg:col-span-5 bg-white rounded-xl shadow-md border-t-4 border-green-600 p-6 flex flex-col gap-4 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded-bl">WORKER NODE</div>
                    <div class="text-center mb-2">
                        <h3 class="text-xl font-bold text-green-700"><i class="fas fa-hard-hat mr-2"></i>Data Plane</h3>
                        <p class="text-xs text-slate-500">The Muscle & Execution</p>
                    </div>

                    <div class="space-y-4">
                        <div class="flex gap-4">
                            <div onclick="showDetails('kubelet')" class="interactive-block flex-1 bg-green-50 border border-green-200 p-3 rounded-lg text-center shadow-sm">
                                <h4 class="font-bold text-green-800 text-sm">Kubelet</h4>
                                <p class="text-xs text-slate-600">The Agent</p>
                            </div>
                            <div onclick="showDetails('proxy')" class="interactive-block flex-1 bg-green-50 border border-green-200 p-3 rounded-lg text-center shadow-sm">
                                <h4 class="font-bold text-green-800 text-sm">Kube-Proxy</h4>
                                <p class="text-xs text-slate-600">Networking</p>
                            </div>
                        </div>

                        <div onclick="showDetails('pods')" class="interactive-block bg-slate-50 border-2 border-dashed border-slate-300 p-4 rounded-lg">
                            <p class="text-xs text-center text-slate-400 mb-2 font-mono">Container Runtime</p>
                            <div class="flex justify-center gap-2">
                                <div class="bg-white border border-slate-200 shadow-sm p-2 rounded w-16 text-center">
                                    <i class="fas fa-box text-blue-500 mb-1"></i>
                                    <div class="text-[10px] font-bold">Pod A</div>
                                </div>
                                <div class="bg-white border border-slate-200 shadow-sm p-2 rounded w-16 text-center">
                                    <i class="fas fa-box text-blue-500 mb-1"></i>
                                    <div class="text-[10px] font-bold">Pod B</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: SCHEDULER LOGIC -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div class="order-2 md:order-1 bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                <h3 class="text-center font-bold text-slate-700 mb-4">The Scheduler's Decision</h3>
                <div class="chart-container">
                    <canvas id="schedulerChart"></canvas>
                </div>
            </div>
            
            <div class="order-1 md:order-2 space-y-6">
                <div class="border-l-4 border-indigo-600 pl-4">
                    <h2 class="text-3xl font-bold text-slate-800">Smart Scheduling</h2>
                    <p class="text-slate-500 font-medium">Bin Packing for Efficiency</p>
                </div>
                <p class="text-lg leading-relaxed text-slate-600">
                    The <strong>Scheduler</strong> effectively plays "Tetris" with your applications to ensure no single node is overloaded.
                </p>
            </div>
        </section>

        <!-- SECTION 4: LIFECYCLE (Timeline) -->
        <section>
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-800">Lifecycle of a Request</h2>
                <p class="text-slate-600">What happens when you type <code>kubectl apply -f pod.yaml</code>?</p>
            </div>

            <div class="relative max-w-3xl mx-auto">
                <div class="absolute left-1/2 transform -translate-x-1/2 h-full w-1 bg-slate-200 rounded"></div>

                <!-- STEP 1 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8">
                        <h4 class="font-bold text-blue-600 text-lg">1. The Request</h4>
                        <p class="text-sm text-slate-600">User sends command to API Server.</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">1</div>
                    <div class="w-5/12 pl-8"></div>
                </div>

                <!-- STEP 2 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8"></div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-amber-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">2</div>
                    <div class="w-5/12 pl-8">
                        <h4 class="font-bold text-amber-600 text-lg">2. Persistence</h4>
                        <p class="text-sm text-slate-600">API Server saves state into <strong>etcd</strong>.</p>
                    </div>
                </div>

                <!-- STEP 3 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8">
                        <h4 class="font-bold text-indigo-600 text-lg">3. Scheduling</h4>
                        <p class="text-sm text-slate-600">Scheduler assigns Pod to a healthy Node.</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-indigo-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">3</div>
                    <div class="w-5/12 pl-8"></div>
                </div>

                <!-- STEP 4 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8"></div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">4</div>
                    <div class="w-5/12 pl-8">
                        <h4 class="font-bold text-green-600 text-lg">4. Execution</h4>
                        <p class="text-sm text-slate-600">Kubelet starts the container.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- COMPONENT MODAL POPUP -->
    <div id="componentModal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] items-center justify-center p-4">
        <div class="modal-content bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden relative">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 text-xl transition-colors">
                <i class="fas fa-times"></i>
            </button>
            <div id="modalHeader" class="p-8 text-white bg-blue-600 transition-colors duration-300">
                <div class="text-[10px] font-bold uppercase tracking-[0.2em] opacity-80 mb-1">K8s Component</div>
                <h3 id="modalTitle" class="text-3xl font-bold">Component Name</h3>
            </div>
            <div class="p-8 space-y-6">
                <div>
                    <div class="flex items-center gap-2 text-blue-600 font-bold uppercase tracking-widest text-[10px] mb-2">
                        <i class="fas fa-microchip"></i> Functional Role
                    </div>
                    <p id="modalDescription" class="text-slate-600 leading-relaxed"></p>
                </div>
                <div class="bg-slate-50 p-5 rounded-xl border border-slate-100">
                    <p class="text-[10px] font-bold text-slate-400 uppercase mb-3 tracking-wider">Key Responsibilities</p>
                    <ul id="modalList" class="text-sm text-slate-700 space-y-2"></ul>
                </div>
            </div>
            <div class="p-4 bg-slate-50 border-t border-slate-100 flex justify-end">
                <button onclick="closeModal()" class="px-8 py-2.5 bg-slate-800 text-white rounded-xl font-bold text-sm hover:bg-slate-900 transition-all shadow-lg active:scale-95">Close Guide</button>
            </div>
        </div>
    </div>

    <footer class="bg-slate-800 text-slate-300 py-12 text-center">
        <p class="mb-2">DevOps Architecture Series</p>
        <p class="text-xs text-slate-500">Visualizing Kubernetes Cluster Internals</p>
    </footer>

    <script>
        // --- DATA MAPPING FOR POP-OUTS ---
        const componentData = {
            api: {
                title: 'Kube-API Server',
                color: 'bg-blue-600',
                desc: 'The central hub and the only component that communicates with the cluster database (etcd). It acts as the gateway for all internal and external requests.',
                tasks: ['RESTful API exposure', 'Request validation & auth', 'Cluster state coordinator']
            },
            scheduler: {
                title: 'Kube-Scheduler',
                color: 'bg-indigo-600',
                desc: 'The "Matchmaker." It watches for newly created Pods that have no node assigned, and selects the best node for them based on resources.',
                tasks: ['Resource filtering', 'Node priority scoring', 'Policy enforcement']
            },
            controller: {
                title: 'Controller Manager',
                color: 'bg-indigo-700',
                desc: 'The "State Police." It runs controller processes that constantly watch the cluster state and work to move the current state toward the desired state.',
                tasks: ['Node monitoring', 'Replication management', 'Endpoint tracking']
            },
            etcd: {
                title: 'etcd',
                color: 'bg-amber-600',
                desc: 'The cluster\'s persistent "Brain." A high-availability key-value store that keeps the record of every configuration and state in the cluster.',
                tasks: ['Source of Truth', 'Configuration storage', 'State persistence']
            },
            kubelet: {
                title: 'Kubelet',
                color: 'bg-green-600',
                desc: 'The "On-site Manager." An agent that runs on every node. It makes sure that containers are actually running in a Pod and are healthy.',
                tasks: ['Pod lifecycle management', 'Health reporting (Liveness/Readiness)', 'Runtime interface (CRI)']
            },
            proxy: {
                title: 'Kube-Proxy',
                color: 'bg-green-700',
                desc: 'The "Network Traffic Controller." It maintains network rules on nodes, allowing network communication to your Pods from inside or outside the cluster.',
                tasks: ['Network rule management', 'IP forwarding (iptables/IPVS)', 'Service load balancing']
            },
            pods: {
                title: 'Pods & Runtime',
                color: 'bg-slate-600',
                desc: 'The smallest units of K8s. A Pod encapsulates one or more containers, storage resources, and a unique network IP.',
                tasks: ['Container isolation', 'Shared storage/network', 'Unit of scaling']
            }
        };

        // --- MODAL LOGIC ---
        function showDetails(key) {
            const data = componentData[key];
            const modal = document.getElementById('componentModal');
            document.getElementById('modalTitle').innerText = data.title;
            document.getElementById('modalDescription').innerText = data.desc;
            document.getElementById('modalHeader').className = `p-8 text-white ${data.color} transition-colors duration-300`;
            
            const list = document.getElementById('modalList');
            list.innerHTML = '';
            data.tasks.forEach(task => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-2';
                li.innerHTML = `<i class="fas fa-check-circle text-blue-500 mt-1"></i> <span>${task}</span>`;
                list.appendChild(li);
            });

            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent scroll
        }

        function closeModal() {
            const modal = document.getElementById('componentModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Close on backdrop click
        window.onclick = function(event) {
            const modal = document.getElementById('componentModal');
            if (event.target == modal) closeModal();
        }

        // --- CHART INITIALIZATION ---
        function wrapLabel(label) {
            if (typeof label !== 'string' || label.length <= 16) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];
            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length < 16) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        const ctxRadar = document.getElementById('comparisonChart').getContext('2d');
        new Chart(ctxRadar, {
            type: 'radar',
            data: {
                labels: ['Self Healing', 'Auto Scaling', 'Setup Simplicity', 'Networking', 'Enterprise Ready'].map(wrapLabel),
                datasets: [
                    {
                        label: 'Kubernetes',
                        data: [9, 9, 3, 9, 10],
                        backgroundColor: 'rgba(50, 108, 229, 0.2)',
                        borderColor: '#326CE5',
                        pointBackgroundColor: '#326CE5'
                    },
                    {
                        label: 'Docker Standalone',
                        data: [1, 2, 9, 4, 3],
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                    }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        const ctxBar = document.getElementById('schedulerChart').getContext('2d');
        new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: ['Node 1 (Busy)', 'Node 2 (Free)', 'Node 3 (Free)'].map(wrapLabel),
                datasets: [
                    { label: 'Used Memory', data: [90, 20, 10], backgroundColor: '#cbd5e1' },
                    { label: 'New Pod Allocation', data: [0, 25, 0], backgroundColor: '#326CE5' },
                    { label: 'Remaining Free', data: [10, 55, 90], backgroundColor: '#e2e8f0' }
                ]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: false,
                scales: { x: { stacked: true }, y: { stacked: true, max: 100 } }
            }
        });
    </script>
</body>
</html>