<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Architecture: The Brain & The Body</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Palette: Vibrant Blue (Based on K8s branding and 'Brilliant Blues') */
        :root {
            --primary: #326CE5; /* K8s Blue */
            --secondary: #39A0F4;
            --accent: #FFEB3B;
            --dark: #1e293b;
            --light: #f8fafc;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--light);
            color: var(--dark);
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* Diagram Connectors (CSS Only - No SVG) */
        .connector-line {
            width: 2px;
            background-color: #cbd5e1;
            flex-grow: 1;
        }
        .connector-arrow::after {
            content: 'â–¼';
            font-size: 12px;
            color: #cbd5e1;
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
        }
    </style>
    <!-- 
    SOURCE MATERIAL ANALYSIS:
    - Subject: Kubernetes Architecture (Master/Worker, Components, Flow).
    - Tone: Educational, Professional, Technical yet Accessible.
    - Narrative: Problem (Docker limitations) -> Solution (K8s) -> Structure (Brain/Body) -> Process (Lifecycle).
    
    VISUALIZATION CHOICES (NO SVG):
    1. Docker vs K8s Comparison -> Radar Chart (Chart.js) -> Goal: Relationship/Compare qualitative metrics.
    2. Architecture Diagram -> HTML/CSS Grid Layout -> Goal: Organize/Structure. Replaces Mermaid.
    3. Scheduler Logic -> Stacked Bar Chart (Chart.js) -> Goal: Inform/Distribution of resources.
    4. Request Lifecycle -> CSS Vertical Timeline -> Goal: Change/Process.

    CONFIRMATION:
    - No Mermaid JS used.
    - No SVG graphics used (FontAwesome Webfonts used for icons).
    - All charts via Canvas.
    -->
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- HERO SECTION -->
    <header class="bg-gradient-to-r from-blue-700 to-cyan-500 text-white p-12 text-center shadow-lg mb-12">
        <h1 class="text-5xl font-bold mb-4">Kubernetes Architecture</h1>
        <p class="text-xl opacity-90 max-w-2xl mx-auto">The "Brain" and the "Body" of modern container orchestration.</p>
        <div class="mt-8 flex justify-center gap-4">
            <span class="bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm"><i class="fas fa-cubes mr-2"></i>Orchestration</span>
            <span class="bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm"><i class="fas fa-heartbeat mr-2"></i>Self-Healing</span>
            <span class="bg-white/20 px-4 py-2 rounded-full backdrop-blur-sm"><i class="fas fa-expand-arrows-alt mr-2"></i>Auto-Scaling</span>
        </div>
    </header>

    <main class="container mx-auto px-4 max-w-6xl space-y-20 pb-20">

        <!-- SECTION 1: THE WHY (Comparison) -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <div class="border-l-4 border-blue-600 pl-4">
                    <h2 class="text-3xl font-bold text-slate-800">Why Kubernetes?</h2>
                    <p class="text-slate-500 font-medium">From Manual to Automatic</p>
                </div>
                <p class="text-lg leading-relaxed text-slate-600">
                    Managing containers with raw Docker is like juggling manually. It works for one or two balls, but fails at scale. Kubernetes (K8s) introduces a "Cluster" mind, bringing enterprise-grade capabilities that standalone Docker lacks.
                </p>
                <ul class="space-y-3">
                    <li class="flex items-center text-slate-700">
                        <span class="w-8 h-8 bg-red-100 text-red-600 rounded-full flex items-center justify-center mr-3"><i class="fas fa-times"></i></span>
                        <span><strong>Docker:</strong> Single Host, No Auto-Healing, Manual Scaling.</span>
                    </li>
                    <li class="flex items-center text-slate-700">
                        <span class="w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center mr-3"><i class="fas fa-check"></i></span>
                        <span><strong>Kubernetes:</strong> Multi-Node Cluster, Auto-Restart, Auto-Scaling.</span>
                    </li>
                </ul>
            </div>
            
            <!-- CHART: Docker vs K8s Radar -->
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                <h3 class="text-center font-bold text-slate-700 mb-4">Capability Comparison</h3>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
                <p class="text-center text-sm text-slate-400 mt-2">K8s excels in resilience and scale, at the cost of initial complexity.</p>
            </div>
        </section>

        <!-- SECTION 2: THE ARCHITECTURE (Diagram) -->
        <section>
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">The Cluster Anatomy</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">A K8s cluster is divided into two planes: The <strong>Control Plane</strong> (Master) which makes decisions, and the <strong>Data Plane</strong> (Workers) which executes them.</p>
            </div>

            <!-- CSS Grid Diagram (Replacing Mermaid/SVG) -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 bg-slate-200 p-6 rounded-2xl border border-slate-300">
                
                <!-- CONTROL PLANE (Master) -->
                <div class="lg:col-span-5 bg-white rounded-xl shadow-md border-t-4 border-blue-600 p-6 flex flex-col gap-4 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded-bl">MASTER NODE</div>
                    <div class="text-center mb-2">
                        <h3 class="text-xl font-bold text-blue-700"><i class="fas fa-brain mr-2"></i>Control Plane</h3>
                        <p class="text-xs text-slate-500">The Brain & Decision Maker</p>
                    </div>

                    <!-- Components -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="col-span-2 bg-blue-50 border border-blue-200 p-3 rounded-lg text-center hover:shadow-md transition-shadow">
                            <h4 class="font-bold text-blue-800 text-sm">API Server</h4>
                            <p class="text-xs text-slate-600">The Gatekeeper (REST API)</p>
                        </div>
                        <div class="bg-indigo-50 border border-indigo-200 p-3 rounded-lg text-center hover:shadow-md transition-shadow">
                            <h4 class="font-bold text-indigo-800 text-sm">Scheduler</h4>
                            <p class="text-xs text-slate-600">The Dispatcher</p>
                        </div>
                        <div class="bg-indigo-50 border border-indigo-200 p-3 rounded-lg text-center hover:shadow-md transition-shadow">
                            <h4 class="font-bold text-indigo-800 text-sm">Controller Mgr</h4>
                            <p class="text-xs text-slate-600">The State Police</p>
                        </div>
                        <div class="col-span-2 bg-amber-50 border border-amber-200 p-3 rounded-lg text-center hover:shadow-md transition-shadow">
                            <h4 class="font-bold text-amber-800 text-sm">etcd</h4>
                            <p class="text-xs text-slate-600">The Memory (Cluster Store)</p>
                        </div>
                    </div>
                </div>

                <!-- CONNECTOR (Visual only) -->
                <div class="lg:col-span-2 flex flex-col justify-center items-center text-slate-400">
                    <div class="hidden lg:block border-t-2 border-dashed border-slate-400 w-full relative top-4"></div>
                    <span class="bg-slate-200 px-2 z-10 font-mono text-xs text-center">HTTPS / API Calls</span>
                    <div class="hidden lg:block border-t-2 border-dashed border-slate-400 w-full relative bottom-4"></div>
                    <div class="lg:hidden text-2xl py-4"><i class="fas fa-arrow-down"></i></div>
                </div>

                <!-- DATA PLANE (Worker) -->
                <div class="lg:col-span-5 bg-white rounded-xl shadow-md border-t-4 border-green-600 p-6 flex flex-col gap-4 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-green-100 text-green-800 text-xs font-bold px-2 py-1 rounded-bl">WORKER NODE</div>
                    <div class="text-center mb-2">
                        <h3 class="text-xl font-bold text-green-700"><i class="fas fa-hard-hat mr-2"></i>Data Plane</h3>
                        <p class="text-xs text-slate-500">The Muscle & Execution</p>
                    </div>

                    <!-- Components -->
                    <div class="space-y-4">
                        <div class="flex gap-4">
                            <div class="flex-1 bg-green-50 border border-green-200 p-3 rounded-lg text-center">
                                <h4 class="font-bold text-green-800 text-sm">Kubelet</h4>
                                <p class="text-xs text-slate-600">The Agent</p>
                            </div>
                            <div class="flex-1 bg-green-50 border border-green-200 p-3 rounded-lg text-center">
                                <h4 class="font-bold text-green-800 text-sm">Kube-Proxy</h4>
                                <p class="text-xs text-slate-600">Networking</p>
                            </div>
                        </div>

                        <!-- POD VISUALIZATION -->
                        <div class="bg-slate-50 border-2 border-dashed border-slate-300 p-4 rounded-lg">
                            <p class="text-xs text-center text-slate-400 mb-2 font-mono">Container Runtime (e.g. containerd)</p>
                            <div class="flex justify-center gap-2">
                                <div class="bg-white border border-slate-200 shadow-sm p-2 rounded w-16 text-center">
                                    <i class="fas fa-box text-blue-500 mb-1"></i>
                                    <div class="text-[10px] font-bold">Pod A</div>
                                </div>
                                <div class="bg-white border border-slate-200 shadow-sm p-2 rounded w-16 text-center">
                                    <i class="fas fa-box text-blue-500 mb-1"></i>
                                    <div class="text-[10px] font-bold">Pod B</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: SCHEDULER LOGIC (Stacked Bar) -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div class="order-2 md:order-1 bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                <h3 class="text-center font-bold text-slate-700 mb-4">The Scheduler's Decision</h3>
                <div class="chart-container">
                    <canvas id="schedulerChart"></canvas>
                </div>
                <div class="mt-4 text-xs text-slate-500 text-center bg-yellow-50 p-2 rounded border border-yellow-100">
                    <i class="fas fa-lightbulb text-yellow-500 mr-1"></i>
                    The Scheduler sees Node 1 is full (Red), so it places the new Pod on Node 2 (Green).
                </div>
            </div>
            
            <div class="order-1 md:order-2 space-y-6">
                <div class="border-l-4 border-indigo-600 pl-4">
                    <h2 class="text-3xl font-bold text-slate-800">Smart Scheduling</h2>
                    <p class="text-slate-500 font-medium">Bin Packing for Efficiency</p>
                </div>
                <p class="text-lg leading-relaxed text-slate-600">
                    The <strong>Scheduler</strong> is the planner. When you ask for a new Pod, the Scheduler checks all Worker Nodes for available CPU and RAM. It effectively plays "Tetris" with your applications to ensure no single node is overloaded while others sit idle.
                </p>
                <div class="bg-slate-100 p-4 rounded-lg border-l-4 border-slate-400">
                    <p class="italic text-slate-600">"API Server, I have found a spot! Node 2 has 40% free memory. Send the Pod there."</p>
                    <div class="text-right text-xs font-bold text-slate-500 mt-2">- The Scheduler</div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: LIFECYCLE (Timeline) -->
        <section>
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-800">Lifecycle of a Request</h2>
                <p class="text-slate-600">What happens when you type <code>kubectl apply -f pod.yaml</code>?</p>
            </div>

            <div class="relative max-w-3xl mx-auto">
                <!-- Vertical Line -->
                <div class="absolute left-1/2 transform -translate-x-1/2 h-full w-1 bg-slate-200 rounded"></div>

                <!-- STEP 1 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8">
                        <h4 class="font-bold text-blue-600 text-lg">1. The Request</h4>
                        <p class="text-sm text-slate-600">User sends command to API Server.</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">1</div>
                    <div class="w-5/12 pl-8"></div>
                </div>

                <!-- STEP 2 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8"></div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-amber-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">2</div>
                    <div class="w-5/12 pl-8">
                        <h4 class="font-bold text-amber-600 text-lg">2. Persistence</h4>
                        <p class="text-sm text-slate-600">API Server saves the "Desired State" into <strong>etcd</strong>.</p>
                    </div>
                </div>

                <!-- STEP 3 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8">
                        <h4 class="font-bold text-indigo-600 text-lg">3. Scheduling</h4>
                        <p class="text-sm text-slate-600">Scheduler sees "Pending" Pod, assigns it to a healthy Node.</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-indigo-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">3</div>
                    <div class="w-5/12 pl-8"></div>
                </div>

                <!-- STEP 4 -->
                <div class="relative flex items-center justify-between mb-8">
                    <div class="w-5/12 text-right pr-8"></div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center border-4 border-white shadow-md z-10 font-bold">4</div>
                    <div class="w-5/12 pl-8">
                        <h4 class="font-bold text-green-600 text-lg">4. Execution</h4>
                        <p class="text-sm text-slate-600">Kubelet on the node pulls the image via Runtime & starts container.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-300 py-8 text-center">
        <p class="mb-2">Generated for Kubernetes Architecture Study</p>
        <p class="text-xs text-slate-500">Vizualizing the Brain and Body of K8s</p>
    </footer>

    <script>
        // --- HELPER FUNCTION: Label Wrapping (16 chars) ---
        function wrapLabel(label) {
            if (typeof label !== 'string' || label.length <= 16) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length < 16) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- CHART 1: Comparison Radar Chart ---
        const ctxRadar = document.getElementById('comparisonChart').getContext('2d');
        const radarLabels = ['Self Healing', 'Auto Scaling', 'Setup Simplicity', 'Networking', 'Enterprise Ready'];
        
        new Chart(ctxRadar, {
            type: 'radar',
            data: {
                labels: radarLabels.map(wrapLabel), // Apply wrapping
                datasets: [
                    {
                        label: 'Kubernetes',
                        data: [9, 9, 3, 9, 10], // High capability, Low simplicity
                        fill: true,
                        backgroundColor: 'rgba(50, 108, 229, 0.2)', // K8s Blue transparent
                        borderColor: '#326CE5',
                        pointBackgroundColor: '#326CE5',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#326CE5'
                    },
                    {
                        label: 'Docker (Standalone)',
                        data: [1, 2, 9, 4, 3], // Low capability, High simplicity
                        fill: true,
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(255, 99, 132, 1)'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { display: true },
                        suggestedMin: 0,
                        suggestedMax: 10
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                if (Array.isArray(label)) {
                                  return label.join(' ');
                                } else {
                                  return label;
                                }
                            }
                        }
                    }
                }
            }
        });

        // --- CHART 2: Scheduler Logic (Stacked Bar) ---
        const ctxBar = document.getElementById('schedulerChart').getContext('2d');
        const barLabels = ['Node 1 (Busy)', 'Node 2 (Free)', 'Node 3 (Mainly Free)'];

        new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: barLabels.map(wrapLabel),
                datasets: [
                    {
                        label: 'Used Memory',
                        data: [90, 20, 10],
                        backgroundColor: '#cbd5e1', // Grey for used
                    },
                    {
                        label: 'New Pod Allocation',
                        data: [0, 25, 0], // The scheduler chooses Node 2
                        backgroundColor: '#326CE5', // Blue for the new pod
                    },
                    {
                        label: 'Remaining Free',
                        data: [10, 55, 90], // Balance
                        backgroundColor: '#e2e8f0', // Light grey for free space
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { stacked: true },
                    y: { 
                        stacked: true,
                        max: 100,
                        title: { display: true, text: 'Capacity %' }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                if (Array.isArray(label)) {
                                  return label.join(' ');
                                } else {
                                  return label;
                                }
                            },
                            afterBody: function(tooltipItems) {
                                if (tooltipItems[0].dataset.label === 'New Pod Allocation' && tooltipItems[0].raw > 0) {
                                    return '\nScheduler Logic: "Node 2 has optimal room!"';
                                }
                            }
                        }
                    },
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    </script>
</body>
</html>